mixin crag(crag, searchQuery)

    .crag
        .crag_img
            a(href=`/all/${crag._id}`)
                //img(src=`/images/locations/${crag.image}`)
                img(src=`http://res.cloudinary.com/dmvzayayq/image/upload/${crag.image}.jpg`)
        .crag_info
            a(href=`/all/${crag._id}`)
                h3= crag.crag_name
            hr
            if url.startsWith('/all/')
                p= crag.crag_description
                hr
            p= `Star rating: ${crag.star_rating}`
            p= `Country: ${crag.country}`
            p= `Guide Cost per day: $ ${crag.cost_per_day}`

        if url.startsWith('/all/')
            hr
            h3 Search for this crag
            .search_nav
                form(action="/results" method="POST")
                    .input_wrapper
                        label(for="destination") Destination
                        input(type="text" id="destination" name="destination" value=crag.crag_name)
                    .input_wrapper
                        label(for="Duration") Duration
                        input(type="text" id="duration" name="duration" required)
                    .input_wrapper
                        label(for="departure-date") Departure Date
                        input(type="date" id="departure-date" name="dateOfDeparture" required)
                    .input_wrapper
                        label(for="number-guests") Number of Guests
                        input(type="text" id="number-guests" name="numberOfGuests" required)

                    .input_wrapper
                        button(type="submit") Search!
                

        if url === '/results' || url.startsWith('/confirmation/')
            .crag_order_details
                p=`Number of nights: ${searchQuery.duration}`
                p= `Departure date: ${searchQuery.dateOfDeparture}`
                - const costEach = searchQuery.duration * crag.cost_per_day
                - const totalCost = costEach * searchQuery.numberOfGuests
                p= `Total per person: $${costEach}`
                hr
                h3= `Total Cost: $${totalCost}`

                -const query = `id=${crag._id}&duration=${searchQuery.duration}&dateOfDeparture=${searchQuery.dateOfDeparture}&numberOfGuests=${searchQuery.numberOfGuests}`;
                if url === '/results'
                    a.button(href= `/confirmation/${query}` ) Continue
                else if url.startsWith('/confirmation/')
                    if user
                        a.button(href=`/order-placed/${query}`) Place your Order
                    else
                        a.button(href='/login') Please log in to order